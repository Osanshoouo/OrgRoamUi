:PROPERTIES:
:ID:       71c2d89f-509d-4630-b372-a6a719a97766
:NOTE_LEVEL: 1
:END:
#+title: Latch & Flip-Flop
#+filetags: :@computerEngineering:@boat:
#+LATEX_HEADER: \usepackage{tikz-timing}
#+LATEX_HEADER: \usepackage{circuitikz}


 * [[id:d62c1289-137d-412a-9ffc-6a81dce51a40][SR Latch]]


 @todo

 add sr latch schematics


 SR Latch is kinda complicated to run, even though its really fast.

[[file:/home/steve/OrgVault/images/computerEngineering/d_latch_graphical_symbol.png]]

 D:     Data we want to be stored (input)
 Clock: Triggers the storage of D into
 Q:     Last stored value of D
 \not{}Q:    Opposite of Q
 (\not{}S:   Set)
 (\not{}R:   Reset)

S and R are our initializers, just the same as when we initialize variables in programming. They would go into the top and bottom. They completely override the values.

The reset signal on a circuit board is usually 1 when we dont try to reset and 0 when we want to reset (active low signal). So when the processor restarts, we want it to be in an expected state. We connect \not{}R to the processors reset and \not{}S to a constant active (1) signal. So when the system goes into reset, the \not{}R overrides Q to a 0. On the other hand we can set Q to 1 on startup by connecting \not{}S to the reset circuit and \not{}R to a constant 1.

@todo @question (rework this mess of a text)



 Both the latch and the Flip Flop have this setup. The difference is just the specifics of the Clock.

** D-FlipFlop and D-Latch


*** Edge triggered (D-Flipflop - flips back and forth on button press)
like a camera, you dont wanna care about how long the button is pressed, just that the button is pressed at all

**** Rising Edge
A Rising Edge is a 0 to 1 transition.
\to Stores D to Q the instant the clock goes from 0 to 1

**** Falling Edge
A Falling Edge is a 1 to 0 transition.
\to Stores D to Q the instant the clock goes from 1 to 0

*** Transparent (D-Latch - latches onto the last value)
Example of the very first image. You had to keep the shutter open for a long period of time. This means you want to keep the shutter open for as long as you keep the button pressed.

**** Active High
Pass D through to Q as long as the clock equals 1. This captures the last value of D to Q when the clock goes to 0.

**** Active Low
Pass D through to Q as long as the clock equals 0. This captures the last value of D to Q when the clock goes to 1.



*** Transparent D Latch Applications

Double purpose pins on processors


when they act as address which memory location they wanted

once the memory device had the adresses, you could use the same data as datalines

you latched the adress data once you wanted to switch to using the data. This way the latch still outputs the adresses you need whil you can work with the data

[[file:/home/steve/OrgVault/images/computerEngineering/processor_using_d_latch_to_split_data_and_adresses.png]]


** Timing Diagrams of Flip-Flops and Latches

\begin{tikcd}
Rising Edge: \texttiming{[-,timing/slope=0]LH} \)
Falling Edge: \texttiming{[-,timing/slope=0]HL} \)
\end{tikcd}

\begin{tikztimingtable}[timing/draw grid]
{D:} & [-,timing/slope=0]1L1H2L2H1L2H3L0.5H1L1.5H \\
{Clock:} & [-,timing/slope=0]5{1.5L1.5H} \\
{Rising Edge:} & [green,timing/slope=0]1.5U9H3L1.5H \\
{Falling Edge:} & [teal,timing/slope=0]1.5U10.5L3H \\
{Active High:} & [orange,timing/slope=0]1.5L 0.5H 2.5L 1.5H 1.5L 1.5H 4.5L 1.5H \\
{Active Low:} & [purple,timing/slope=0 ]1L 0.5H 1.5H 1L 2H 1L 2H 3L 0.5H 2.5L \\
\extracode
\vertlines[gray]{1.5,3,...,\twidth}
\end{tikztimingtable}

All of these Store D into Q, how the actual output looks is very very differnt though.



** D Flip-Flop Event Detector
what if the processor is busy while the user presses the button, and only gets around to looking at the I/O after the user took their finger off the button

So we want a button to be a lever

\begin{tikztimingtable}[timing/draw grid]
{User Input:} & [-,timing/slope=0] 1L 1H 1L \\
{Q:} & [-,timing/slope=0] 1L 2H \\
{not Q:} & [-,timing/slope=0] 1H 2L \\
\end{tikztimingtable}

In the circuit:
\begin{tikzpicture}
	% Paths, nodes and wires:
	\node[latch, add async SR] at (8.63, -0.09){};
	\node[shape=rectangle, draw, line width=1pt, minimum width=0.715cm, minimum height=0.715cm] at (8.625, 1.875){} node[anchor=center, align=center, text width=0.327cm, inner sep=6pt] at (8.625, 1.875){\scriptsize 1};
	\draw (7.51, -0.93) -| (5.75, -0.75);
	\node[shape=rectangle, draw, line width=1pt, minimum width=0.965cm, minimum height=0.965cm] at (5.75, -0.25){};
	\node[shape=rectangle, minimum width=0.965cm, minimum height=0.965cm] at (5.75, -0.25){} node[anchor=center, align=center, text width=0.577cm, inner sep=6pt] at (5.75, -0.25){D};
	\draw (8.63, -1.63) -| (8.63, -2) -- (8.63, -1.63);
	\node[shape=rectangle, minimum width=2.715cm, minimum height=0.965cm] at (9.435, -2.5){} node[anchor=north west, align=left, text width=2.327cm, inner sep=6pt] at (8.06, -2){\footnotesize Switches to logic 0 on Startup for a moment to get a 0 on Q};
	\node[shape=rectangle, draw, line width=1pt, minimum width=0.715cm, minimum height=0.715cm] at (7.135, 0.75){} node[anchor=center, align=center, text width=0.327cm, inner sep=6pt] at (7.135, 0.75){\scriptsize 1};
	\node[shape=rectangle, draw, line width=1pt, minimum width=0.715cm, minimum height=0.715cm] at (10.125, 0.75){} node[anchor=center, align=center, text width=0.327cm, inner sep=6pt] at (10.125, 0.75){\scriptsize 1};
	\node[shape=rectangle, draw, line width=1pt, minimum width=0.715cm, minimum height=0.715cm] at (6.625, -1.75){} node[anchor=center, align=center, text width=0.327cm, inner sep=6pt] at (6.625, -1.75){\scriptsize 0};
	\node[shape=rectangle, draw, line width=1pt, minimum width=0.715cm, minimum height=0.715cm] at (6.625, -2.875){} node[anchor=center, align=center, text width=0.327cm, inner sep=6pt] at (6.625, -2.875){\scriptsize 1};
	\draw (8.63, -2) to[switch] (7, -2);
	\draw (7.75, -2.25) -- (7, -2.75);
\end{tikzpicture}

So if D is ever 1, then Q will latch onto the 1 until it is reset. The reset works by setting the Reset to 0 for a moment, overriding the Q value to 0.
